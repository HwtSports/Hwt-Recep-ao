<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recep칞칚o HWT - Sistema Hoteleiro Sincronizado</title>
    <meta name="description" content="Sistema gratuito de gest칚o hoteleira para pequenos hot칠is e pousadas com sincroniza칞칚o em tempo real">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --laranja: #FF8C00;
            --laranja-claro: #FFA500;
            --laranja-escuro: #E67E00;
            --cinza: #333333;
            --cinza-claro: #f4f4f4;
            --cinza-medio: #e0e0e0;
            --branco: #ffffff;
            --verde: #4CAF50;
            --vermelho: #F44336;
            --azul: #2196F3;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--cinza-claro);
            color: var(--cinza);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Tela de Login */
        #login-screen {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--laranja) 0%, var(--cinza) 100%);
        }
        
        .login-container {
            background-color: var(--branco);
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 400px;
            padding: 40px 30px;
            text-align: center;
        }
        
        .login-logo {
            font-size: 2.8rem;
            font-weight: bold;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }
        
        .logo-hwt {
            color: var(--laranja);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .login-subtitle {
            color: var(--cinza);
            margin-bottom: 30px;
            font-size: 1rem;
            opacity: 0.8;
        }
        
        .login-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--cinza-medio);
        }
        
        .login-tab {
            flex: 1;
            padding: 12px;
            background: none;
            border: none;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            color: var(--cinza);
            transition: all 0.3s;
        }
        
        .login-tab.active {
            color: var(--laranja);
            border-bottom: 3px solid var(--laranja);
        }
        
        .login-form {
            display: none;
        }
        
        .login-form.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--cinza);
        }
        
        input, select, button {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--cinza-medio);
            border-radius: 6px;
            font-size: 1rem;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--laranja);
            box-shadow: 0 0 0 2px rgba(255, 140, 0, 0.2);
        }
        
        button {
            background-color: var(--laranja);
            color: var(--branco);
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
            margin-top: 10px;
        }
        
        button:hover {
            background-color: var(--laranja-escuro);
        }
        
        .secondary-btn {
            background-color: transparent;
            color: var(--cinza);
            border: 1px solid var(--cinza-medio);
        }
        
        .secondary-btn:hover {
            background-color: var(--cinza-claro);
        }
        
        /* Sistema Principal */
        #main-system {
            display: none;
        }
        
        header {
            background-color: var(--branco);
            color: var(--cinza);
            padding: 15px 20px;
            text-align: center;
            border-radius: 8px 8px 0 0;
            position: relative;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .user-name {
            margin-right: 15px;
            color: var(--cinza);
        }
        
        .logout-btn {
            width: auto;
            padding: 6px 12px;
            font-size: 0.8rem;
            background-color: var(--cinza);
        }
        
        .logout-btn:hover {
            background-color: #555;
        }
        
        .logo {
            font-size: 2.2rem;
            font-weight: bold;
            letter-spacing: 1px;
        }
        
        .logo-hwt {
            color: var(--laranja);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        nav {
            background-color: var(--cinza);
            padding: 10px 0;
            border-radius: 0 0 8px 8px;
        }
        
        nav ul {
            display: flex;
            justify-content: center;
            list-style: none;
        }
        
        nav li {
            margin: 0 15px;
        }
        
        nav a {
            color: var(--branco);
            text-decoration: none;
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        
        nav a:hover {
            background-color: var(--laranja);
        }
        
        .tab-content {
            display: none;
            margin-top: 20px;
            background-color: var(--branco);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .active {
            display: block;
        }
        
        .quartos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .quarto {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        
        .quarto.disponivel {
            background-color: #e8f5e9;
            border-color: var(--verde);
        }
        
        .quarto.ocupado {
            background-color: #ffebee;
            border-color: var(--vermelho);
        }
        
        .quarto:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .quarto-numero {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .quarto-status {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .quarto.disponivel .quarto-status {
            color: var(--verde);
        }
        
        .quarto.ocupado .quarto-status {
            color: var(--vermelho);
        }
        
        .quarto-pessoas {
            font-size: 0.9rem;
            color: var(--cinza);
            margin-bottom: 10px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: var(--laranja);
            color: var(--branco);
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        .alert {
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-content {
            background-color: var(--branco);
            padding: 20px;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        .close {
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--cinza);
        }
        
        .checkout-btn {
            background-color: var(--vermelho);
            width: auto;
            padding: 5px 10px;
            font-size: 0.9rem;
        }
        
        .checkout-btn:hover {
            background-color: #d32f2f;
        }
        
        .andar-selector {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .andar-btn {
            width: auto;
            margin: 0 5px;
            padding: 8px 15px;
        }
        
        .andar-btn.active {
            background-color: var(--cinza);
        }
        
        .quantidade-info {
            display: inline-block;
            background-color: var(--laranja);
            color: var(--branco);
            border-radius: 50%;
            width: 25px;
            height: 25px;
            text-align: center;
            line-height: 25px;
            margin-left: 5px;
            font-size: 0.8rem;
        }
        
        .edit-btn {
            background-color: var(--azul);
            width: auto;
            padding: 5px 10px;
            font-size: 0.9rem;
            margin-top: 10px;
        }
        
        .edit-btn:hover {
            background-color: #0b7dda;
        }
        
        .page-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--cinza);
            border-bottom: 2px solid var(--laranja);
            padding-bottom: 8px;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-dot.disponivel {
            background-color: var(--verde);
        }
        
        .status-dot.ocupado {
            background-color: var(--vermelho);
        }
        
        .hospede-secao {
            margin-bottom: 20px;
            padding: 15px;
            background-color: var(--cinza-claro);
            border-radius: 6px;
        }
        
        .hospede-titulo {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--cinza);
            border-bottom: 1px solid var(--cinza-medio);
            padding-bottom: 5px;
        }
        
        .time-inputs {
            display: flex;
            gap: 10px;
        }
        
        .time-inputs .form-group {
            flex: 1;
        }
        
        .data-hora-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px 15px;
            background-color: var(--laranja);
            color: var(--branco);
            border-radius: 6px;
            font-weight: bold;
        }
        
        .data-atual, .hora-atual {
            font-size: 1.1rem;
        }

        .status-historico {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 8px;
        }
        
        .status-ativo {
            background-color: var(--verde);
            color: white;
        }
        
        .status-finalizado {
            background-color: var(--cinza);
            color: white;
        }
        
        .status-automatico {
            background-color: var(--laranja);
            color: white;
        }
        
        /* Estilos para o hist칩rico com abas */
        .historico-accordion {
            margin-top: 20px;
        }
        
        .historico-item {
            border: 1px solid var(--cinza-medio);
            border-radius: 6px;
            margin-bottom: 10px;
            overflow: hidden;
        }
        
        .historico-header {
            background-color: var(--cinza-claro);
            padding: 15px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .historico-header:hover {
            background-color: var(--cinza-medio);
        }
        
        .historico-header.active {
            background-color: var(--laranja);
            color: white;
        }
        
        .historico-info {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .historico-info-item {
            display: flex;
            flex-direction: column;
        }
        
        .historico-info-label {
            font-size: 0.8rem;
            color: var(--cinza);
        }
        
        .historico-info-value {
            font-weight: bold;
        }
        
        .historico-detalhes {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s ease;
            background-color: var(--branco);
        }
        
        .historico-detalhes.active {
            padding: 20px;
            max-height: 500px;
        }
        
        .detalhes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .detalhes-item {
            margin-bottom: 10px;
        }
        
        .detalhes-label {
            font-weight: bold;
            color: var(--cinza);
            margin-bottom: 5px;
        }
        
        .detalhes-value {
            padding: 8px;
            background-color: var(--cinza-claro);
            border-radius: 4px;
        }
        
        .historico-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .btn-detalhes {
            background-color: transparent;
            border: 1px solid var(--laranja);
            color: var(--laranja);
            width: auto;
            padding: 5px 10px;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .btn-detalhes:hover {
            background-color: var(--laranja);
            color: white;
        }
        
        .btn-detalhes i {
            margin-right: 5px;
        }
        
        .btn-detalhes.aberto {
            background-color: var(--laranja);
            color: white;
        }
        
        .toggle-icon {
            transition: transform 0.3s;
        }
        
        .toggle-icon.aberto {
            transform: rotate(180deg);
        }
        
        .historico-filtros {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filtro-item {
            flex: 1;
            min-width: 150px;
        }
        
        .historico-vazio {
            text-align: center;
            padding: 40px;
            color: var(--cinza-medio);
            font-style: italic;
        }
        
        .hospede-info {
            margin-bottom: 10px;
            padding: 10px;
            background-color: var(--cinza-claro);
            border-radius: 4px;
        }
        
        .hospede-info-label {
            font-weight: bold;
            color: var(--cinza);
        }
        
        .info-box {
            margin-top: 15px;
            padding: 10px;
            background-color: #e3f2fd;
            border-radius: 4px;
            font-size: 0.9rem;
            text-align: center;
        }
        
        .sync-indicator {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            color: var(--cinza);
            margin-left: 15px;
        }
        
        .sync-status {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        
        .sync-online {
            background-color: var(--verde);
        }
        
        .sync-offline {
            background-color: var(--vermelho);
        }
        
        .sync-pending {
            background-color: var(--laranja);
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .last-update {
            font-size: 0.8rem;
            color: var(--cinza);
            margin-top: 5px;
            text-align: right;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .logo {
                font-size: 1.8rem;
            }
            
            nav ul {
                flex-direction: column;
                gap: 10px;
            }
            
            .quartos-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
            
            .data-hora-container {
                flex-direction: column;
                gap: 10px;
            }
            
            .historico-filtros {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Tela de Login -->
    <div id="login-screen">
        <div class="login-container">
            <div class="login-logo">
                <span class="logo-hwt">Recep칞칚o HWT</span>
            </div>
            <div class="login-subtitle">Sistema de Gest칚o Hoteleira Sincronizado</div>
            
            <div class="login-tabs">
                <button class="login-tab active" data-tab="login">Entrar</button>
                <button class="login-tab" data-tab="register">Criar Usu치rio</button>
            </div>
            
            <form id="login-form" class="login-form active">
                <div class="form-group">
                    <label for="login-username">Usu치rio</label>
                    <input type="text" id="login-username" required>
                </div>
                
                <div class="form-group">
                    <label for="login-password">Senha</label>
                    <input type="password" id="login-password" required>
                </div>
                
                <button type="submit">Entrar</button>
            </form>
            
            <form id="register-form" class="login-form">
                <div class="form-group">
                    <label for="register-name">Nome Completo</label>
                    <input type="text" id="register-name" required>
                </div>
                
                <div class="form-group">
                    <label for="register-username">Usu치rio</label>
                    <input type="text" id="register-username" required>
                </div>
                
                <div class="form-group">
                    <label for="register-password">Senha</label>
                    <input type="password" id="register-password" required>
                </div>
                
                <div class="form-group">
                    <label for="register-confirm-password">Confirmar Senha</label>
                    <input type="password" id="register-confirm-password" required>
                </div>
                
                <button type="submit">Criar Usu치rio</button>
                <div class="info-box">
                    <i class="fas fa-info-circle"></i> Limite m치ximo: 4 usu치rios no sistema
                </div>
            </form>
        </div>
    </div>
    
    <!-- Sistema Principal -->
    <div id="main-system" class="container">
        <header>
            <div class="logo">
                <span class="logo-hwt">Recep칞칚o HWT</span>
            </div>
            <div class="user-info">
                <span class="user-name">Ol치, <span id="current-user">Usu치rio</span></span>
                <div class="sync-indicator">
                    <span class="sync-status sync-online" id="sync-status"></span>
                    <span id="sync-text">Sincronizado</span>
                </div>
                <button class="logout-btn" id="logout-btn">Sair</button>
            </div>
        </header>
        
        <nav>
            <ul>
                <li><a href="#" class="nav-link" data-tab="quartos">Quartos <span id="quantidade-quartos" class="quantidade-info">0</span></a></li>
                <li><a href="#" class="nav-link" data-tab="ocupados">Ocupados <span id="quantidade-hospedes" class="quantidade-info">0</span></a></li>
                <li><a href="#" class="nav-link" data-tab="historico">Hist칩rico</a></li>
            </ul>
        </nav>
        
        <div class="last-update" id="last-update">
            칔ltima atualiza칞칚o: <span id="last-update-time">--:--:--</span>
        </div>
        
        <div id="quartos" class="tab-content active">
            <h2 class="page-title">Quartos</h2>
            
            <!-- Container para data e hora atual -->
            <div class="data-hora-container">
                <div class="data-atual" id="data-atual"></div>
                <div class="hora-atual" id="hora-atual"></div>
            </div>
            
            <div class="andar-selector">
                <button class="andar-btn active" data-andar="terreo">T칠rreo</button>
                <button class="andar-btn" data-andar="primeiro">Primeiro Andar</button>
                <button class="andar-btn" data-andar="segundo">Segundo Andar</button>
                <button class="andar-btn" data-andar="tenis">T칡nis Academy</button>
                <button class="andar-btn" data-andar="soccer">Soccer Academy</button>
            </div>
            <div id="quartos-container" class="quartos-grid">
                <!-- Quartos ser칚o carregados aqui via JavaScript -->
            </div>
        </div>
        
        <div id="ocupados" class="tab-content">
            <h2 class="page-title">Ocupados</h2>
            <table id="tabela-hospedes">
                <thead>
                    <tr>
                        <th>Quarto</th>
                        <th>H칩spedes</th>
                        <th>Documentos</th>
                        <th>Telefones</th>
                        <th>Pessoas</th>
                        <th>Entrada</th>
                        <th>Sa칤da</th>
                        <th>A칞칚o</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Dados ser칚o preenchidos via JavaScript -->
                </tbody>
            </table>
        </div>
        
        <div id="historico" class="tab-content">
            <h2 class="page-title">Hist칩rico</h2>
            
            <div class="historico-filtros">
                <div class="form-group filtro-item">
                    <label for="filtro-status">Status</label>
                    <select id="filtro-status">
                        <option value="todos">Todos</option>
                        <option value="ativo">Ativos</option>
                        <option value="finalizado">Finalizados</option>
                        <option value="automatico">Auto Finalizados</option>
                    </select>
                </div>
                
                <div class="form-group filtro-item">
                    <label for="filtro-data-entrada">Data de Entrada</label>
                    <input type="date" id="filtro-data-entrada">
                </div>
                
                <div class="form-group filtro-item">
                    <label for="filtro-quarto">Quarto</label>
                    <input type="number" id="filtro-quarto" placeholder="N칰mero do quarto">
                </div>
            </div>
            
            <div class="historico-accordion" id="historico-accordion">
                <!-- Hist칩rico ser치 carregado aqui via JavaScript -->
            </div>
        </div>
    </div>
    
    <!-- Modal para detalhes do quarto -->
    <div id="modal-quarto" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-titulo">Detalhes do Quarto</h3>
                <span class="close">&times;</span>
            </div>
            <div id="modal-conteudo">
                <!-- Conte칰do ser치 preenchido via JavaScript -->
            </div>
        </div>
    </div>
    
    <!-- Modal para editar check-in -->
    <div id="modal-editar-checkin" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-editar-titulo">Editar Check-in</h3>
                <span class="close close-editar">&times;</span>
            </div>
            <form id="editar-checkin-form">
                <input type="hidden" id="editar-quarto">
                
                <div class="form-group">
                    <label for="editar-status">Status do Quarto</label>
                    <select id="editar-status" required>
                        <option value="disponivel">Dispon칤vel</option>
                        <option value="ocupado">Ocupado</option>
                    </select>
                </div>
                
                <div id="editar-campos-ocupado">
                    <div class="form-group">
                        <label for="editar-num-pessoas">N칰mero de Pessoas</label>
                        <select id="editar-num-pessoas" required>
                            <option value="1">1 Pessoa</option>
                            <option value="2">2 Pessoas</option>
                            <option value="3">3 Pessoas</option>
                        </select>
                    </div>
                    
                    <div id="editar-campos-hospedes">
                        <!-- Campos dos h칩spedes ser칚o gerados dinamicamente -->
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editar-data-entrada">Data de Entrada</label>
                            <input type="date" id="editar-data-entrada" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="editar-data-saida">Data de Sa칤da</label>
                            <input type="date" id="editar-data-saida" required>
                        </div>
                    </div>
                    
                    <div class="time-inputs">
                        <div class="form-group">
                            <label for="editar-hora-entrada">Hora de Entrada</label>
                            <input type="time" id="editar-hora-entrada" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="editar-hora-saida">Hora de Sa칤da</label>
                            <input type="time" id="editar-hora-saida" required>
                        </div>
                    </div>
                </div>
                
                <button type="submit">Salvar Altera칞칫es</button>
                <button type="button" class="secondary-btn" id="cancelar-edicao">Cancelar</button>
            </form>
        </div>
    </div>
    
    <script>
        // Dados iniciais
        const quartos = {
            terreo: [1, 2, 3, 4, 5, 6, 7, 8, 9],
            primeiro: [100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123],
            segundo: [200, 201, 202, 203, 204],
            tenis: [25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40],
            soccer: [11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
        };
        
        let usuarios = JSON.parse(localStorage.getItem('usuariosHWT')) || [
            { nome: "Administrador", usuario: "admin", senha: "admin123" }
        ];
        
        let usuarioAtual = null;
        let hospedesAtivos = JSON.parse(localStorage.getItem('hospedesAtivos')) || [];
        let historico = JSON.parse(localStorage.getItem('historico')) || [];
        let andarAtual = 'terreo';
        let intervaloAtualizacao;
        let ultimaAtualizacao = localStorage.getItem('ultimaAtualizacaoHWT') || null;
        let sincronizando = false;

        // 游댃 SISTEMA DE SINCRONIZA칂츾O SIMPLES ENTRE COMPUTADORES
        function sincronizarEntreComputadores() {
            if (sincronizando) return;
            
            // Usando um servidor p칰blico gratuito para sincroniza칞칚o
            const url = 'https://jsonblob.com/api/jsonBlob/12345678-1234-1234-1234-123456789012';
            
            fetch(url)
                .then(response => response.json())
                .then(dadosRemotos => {
                    if (dadosRemotos && dadosRemotos.ultimaAtualizacao && 
                        dadosRemotos.ultimaAtualizacao !== ultimaAtualizacao) {
                        
                        // Atualizar com dados da nuvem
                        hospedesAtivos = dadosRemotos.hospedesAtivos || hospedesAtivos;
                        historico = dadosRemotos.historico || historico;
                        usuarios = dadosRemotos.usuarios || usuarios;
                        ultimaAtualizacao = dadosRemotos.ultimaAtualizacao;
                        
                        salvarDados();
                        carregarQuartos();
                        carregarHospedesAtivos();
                        carregarHistorico();
                        atualizarQuantidades();
                    }
                })
                .catch(error => {
                    console.log('Modo offline - usando dados locais');
                });
        }

        function enviarParaNuvem() {
            const dados = {
                hospedesAtivos: hospedesAtivos,
                historico: historico,
                usuarios: usuarios,
                ultimaAtualizacao: ultimaAtualizacao
            };
            
            // Enviar para servidor p칰blico
            fetch('https://jsonblob.com/api/jsonBlob/12345678-1234-1234-1234-123456789012', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(dados)
            })
            .catch(error => {
                console.log('Falha ao enviar para nuvem');
            });
        }

        // Inicializa칞칚o
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar se j치 existe um usu치rio logado
            const usuarioSalvo = localStorage.getItem('usuarioAtualHWT');
            if (usuarioSalvo) {
                usuarioAtual = JSON.parse(usuarioSalvo);
                mostrarSistemaPrincipal();
            }
            
            // Configurar abas de login/cadastro
            document.querySelectorAll('.login-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Ativar aba clicada
                    document.querySelectorAll('.login-tab').forEach(t => {
                        t.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Mostrar formul치rio correspondente
                    document.querySelectorAll('.login-form').forEach(form => {
                        form.classList.remove('active');
                    });
                    document.getElementById(`${tabId}-form`).classList.add('active');
                });
            });
            
            // Configurar formul치rio de login
            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                fazerLogin();
            });
            
            // Configurar formul치rio de cadastro
            document.getElementById('register-form').addEventListener('submit', function(e) {
                e.preventDefault();
                criarUsuario();
            });
            
            // Configurar bot칚o de logout
            document.getElementById('logout-btn').addEventListener('click', function() {
                fazerLogout();
            });
            
            // Configurar datas m칤nimas
            const hoje = new Date().toISOString().split('T')[0];
            document.getElementById('editar-data-entrada').min = hoje;
            document.getElementById('editar-data-saida').min = hoje;
            
            // Configurar mudan칞a de status no formul치rio de edi칞칚o
            document.getElementById('editar-status').addEventListener('change', function() {
                const camposOcupado = document.getElementById('editar-campos-ocupado');
                if (this.value === 'ocupado') {
                    camposOcupado.style.display = 'block';
                } else {
                    camposOcupado.style.display = 'none';
                }
            });
            
            // Configurar mudan칞a no n칰mero de pessoas
            document.getElementById('editar-num-pessoas').addEventListener('change', function() {
                atualizarCamposHospedes();
            });
            
            // Configurar filtros do hist칩rico
            document.getElementById('filtro-status').addEventListener('change', carregarHistorico);
            document.getElementById('filtro-data-entrada').addEventListener('change', carregarHistorico);
            document.getElementById('filtro-quarto').addEventListener('input', carregarHistorico);
            
            // Carregar dados iniciais
            carregarQuartos();
            carregarHospedesAtivos();
            carregarHistorico();
            atualizarQuantidades();
            
            // Configurar navega칞칚o por abas
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tabId = this.getAttribute('data-tab');
                    
                    // Esconder todas as abas
                    document.querySelectorAll('.tab-content').forEach(tab => {
                        tab.classList.remove('active');
                    });
                    
                    // Mostrar a aba selecionada
                    document.getElementById(tabId).classList.add('active');
                });
            });
            
            // Configurar seletor de andar
            document.querySelectorAll('.andar-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.andar-btn').forEach(b => {
                        b.classList.remove('active');
                    });
                    this.classList.add('active');
                    andarAtual = this.getAttribute('data-andar');
                    carregarQuartos();
                });
            });
            
            // Configurar formul치rio de edi칞칚o
            document.getElementById('editar-checkin-form').addEventListener('submit', function(e) {
                e.preventDefault();
                salvarEdicaoCheckin();
            });
            
            // Configurar bot칚o de cancelar edi칞칚o
            document.getElementById('cancelar-edicao').addEventListener('click', function() {
                document.getElementById('modal-editar-checkin').style.display = 'none';
            });
            
            // Configurar modais
            document.querySelector('.close').addEventListener('click', function() {
                document.getElementById('modal-quarto').style.display = 'none';
            });
            
            document.querySelector('.close-editar').addEventListener('click', function() {
                document.getElementById('modal-editar-checkin').style.display = 'none';
            });
            
            // Fechar modal ao clicar fora
            window.addEventListener('click', function(e) {
                if (e.target === document.getElementById('modal-quarto')) {
                    document.getElementById('modal-quarto').style.display = 'none';
                }
                if (e.target === document.getElementById('modal-editar-checkin')) {
                    document.getElementById('modal-editar-checkin').style.display = 'none';
                }
            });
            
            // Iniciar sistema de sincroniza칞칚o
            iniciarSincronizacao();
        });

        // Sistema de sincroniza칞칚o
        function iniciarSincronizacao() {
            // Sincronizar a cada 10 segundos
            setInterval(sincronizarEntreComputadores, 10000);
            
            // Atualizar indicador de sincroniza칞칚o
            atualizarIndicadorSincronizacao();
        }

        function atualizarIndicadorSincronizacao(status = 'sincronizado') {
            const statusElement = document.getElementById('sync-status');
            const textElement = document.getElementById('sync-text');
            
            statusElement.className = 'sync-status';
            
            switch(status) {
                case 'sincronizado':
                    statusElement.classList.add('sync-online');
                    textElement.textContent = 'Sincronizado';
                    break;
                case 'sincronizando':
                    statusElement.classList.add('sync-pending');
                    textElement.textContent = 'Sincronizando...';
                    break;
                case 'erro':
                    statusElement.classList.add('sync-offline');
                    textElement.textContent = 'Offline';
                    break;
            }
        }

        // Fun칞칚o para atualizar campos de h칩spedes dinamicamente
        function atualizarCamposHospedes() {
            const numPessoas = parseInt(document.getElementById('editar-num-pessoas').value);
            const container = document.getElementById('editar-campos-hospedes');
            container.innerHTML = '';
            
            // Determinar o n칰mero m치ximo de pessoas baseado no setor
            const quarto = parseInt(document.getElementById('editar-quarto').value);
            const maxPessoas = (andarAtual === 'tenis' || andarAtual === 'soccer') ? 3 : 2;
            
            // Atualizar as op칞칫es dispon칤veis no select
            const selectNumPessoas = document.getElementById('editar-num-pessoas');
            selectNumPessoas.innerHTML = '';
            
            for (let i = 1; i <= maxPessoas; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `${i} Pessoa${i > 1 ? 's' : ''}`;
                selectNumPessoas.appendChild(option);
            }
            
            // Definir o valor atual
            selectNumPessoas.value = Math.min(numPessoas, maxPessoas);
            
            // Criar campos para cada h칩spede
            for (let i = 1; i <= selectNumPessoas.value; i++) {
                const hospedeSecao = document.createElement('div');
                hospedeSecao.className = 'hospede-secao';
                hospedeSecao.innerHTML = `
                    <div class="hospede-titulo">H칩spede ${i} ${i === 1 ? '(Principal)' : ''}</div>
                    <div class="form-group">
                        <label for="editar-nome-hospede${i}">Nome Completo</label>
                        <input type="text" id="editar-nome-hospede${i}" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editar-documento${i}">Documento de Identifica칞칚o</label>
                        <input type="text" id="editar-documento${i}" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editar-telefone${i}">Telefone para Contato</label>
                        <input type="tel" id="editar-telefone${i}" required>
                    </div>
                `;
                container.appendChild(hospedeSecao);
            }
        }

        // Fun칞칚o para atualizar data e hora atual
        function atualizarDataHora() {
            const agora = new Date();
            
            // Formatar data (Brasil)
            const dataFormatada = agora.toLocaleDateString('pt-BR', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
            
            // Formatar hora (Brasil)
            const horaFormatada = agora.toLocaleTimeString('pt-BR', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            
            // Atualizar elementos na p치gina
            document.getElementById('data-atual').textContent = `Data: ${dataFormatada}`;
            document.getElementById('hora-atual').textContent = `Hora: ${horaFormatada}`;
            
            // Verificar se algum quarto precisa ser liberado automaticamente
            verificarLiberacaoAutomatica();
        }

        // Fun칞칚o para verificar e liberar quartos automaticamente
        function verificarLiberacaoAutomatica() {
            const agora = new Date();
            const dataAtual = agora.toISOString().split('T')[0];
            const horaAtual = agora.toTimeString().split(' ')[0].substring(0, 5); // Formato HH:MM
            
            let quartosLiberados = false;
            
            // Verificar cada h칩spede ativo
            hospedesAtivos.forEach((hospede, index) => {
                // Verificar se a data de sa칤da 칠 hoje ou anterior
                if (hospede.saida <= dataAtual) {
                    // Se for hoje, verificar se j치 passou do hor치rio de sa칤da
                    if (hospede.saida === dataAtual) {
                        if (hospede.horaSaida && horaAtual >= hospede.horaSaida) {
                            // Liberar quarto automaticamente
                            liberarQuartoAutomaticamente(hospede.quarto, index);
                            quartosLiberados = true;
                        }
                    } else {
                        // Se a data de sa칤da j치 passou, liberar quarto
                        liberarQuartoAutomaticamente(hospede.quarto, index);
                        quartosLiberados = true;
                    }
                }
            });
            
            // Se algum quarto foi liberado, atualizar a interface
            if (quartosLiberados) {
                carregarQuartos();
                carregarHospedesAtivos();
                atualizarQuantidades();
            }
        }

        // Fun칞칚o para liberar quarto automaticamente
        function liberarQuartoAutomaticamente(quarto, index) {
            const hospede = hospedesAtivos[index];
            
            // Atualizar o registro no hist칩rico para marcar como finalizado
            const registroHistorico = historico.find(h => 
                h.quarto === quarto && h.status === 'ativo' && !h.dataSaidaReal
            );
            
            if (registroHistorico) {
                registroHistorico.status = 'finalizado';
                registroHistorico.dataSaidaReal = new Date().toISOString().split('T')[0];
                registroHistorico.horaSaidaReal = new Date().toTimeString().split(' ')[0].substring(0, 5);
                registroHistorico.checkoutAutomatico = true;
            }
            
            // Remover dos h칩spedes ativos
            hospedesAtivos.splice(index, 1);
            
            // Salvar dados e notificar mudan칞a
            salvarDados();
            
            console.log(`Quarto ${quarto} liberado automaticamente - Hor치rio de sa칤da atingido`);
        }
        
        // Fun칞칚o para fazer login
        function fazerLogin() {
            const usuario = document.getElementById('login-username').value;
            const senha = document.getElementById('login-password').value;
            
            const usuarioEncontrado = usuarios.find(u => u.usuario === usuario && u.senha === senha);
            
            if (usuarioEncontrado) {
                usuarioAtual = usuarioEncontrado;
                localStorage.setItem('usuarioAtualHWT', JSON.stringify(usuarioAtual));
                mostrarSistemaPrincipal();
            } else {
                alert('Usu치rio ou senha incorretos!');
            }
        }
        
        // Fun칞칚o para criar usu치rio
        function criarUsuario() {
            const nome = document.getElementById('register-name').value;
            const usuario = document.getElementById('register-username').value;
            const senha = document.getElementById('register-password').value;
            const confirmarSenha = document.getElementById('register-confirm-password').value;
            
            // Verificar se as senhas coincidem
            if (senha !== confirmarSenha) {
                alert('As senhas n칚o coincidem!');
                return;
            }
            
            // Verificar se o usu치rio j치 existe
            if (usuarios.find(u => u.usuario === usuario)) {
                alert('Este nome de usu치rio j치 est치 em uso!');
                return;
            }
            
            // Verificar limite de usu치rios (m치ximo 4)
            if (usuarios.length >= 4) {
                alert('Limite m치ximo de 4 usu치rios atingido! N칚o 칠 poss칤vel criar mais usu치rios.');
                return;
            }
            
            // Adicionar novo usu치rio
            const novoUsuario = { nome, usuario, senha };
            usuarios.push(novoUsuario);
            localStorage.setItem('usuariosHWT', JSON.stringify(usuarios));
            
            alert('Usu치rio criado com sucesso! Fa칞a login para continuar.');
            
            // Limpar formul치rio e voltar para a tela de login
            document.getElementById('register-form').reset();
            document.querySelector('.login-tab[data-tab="login"]').click();
        }
        
        // Fun칞칚o para fazer logout
        function fazerLogout() {
            usuarioAtual = null;
            localStorage.removeItem('usuarioAtualHWT');
            document.getElementById('login-screen').style.display = 'flex';
            document.getElementById('main-system').style.display = 'none';
            document.getElementById('login-form').reset();
            
            // Parar a atualiza칞칚o da data e hora
            if (intervaloAtualizacao) {
                clearInterval(intervaloAtualizacao);
            }
        }
        
        // Fun칞칚o para mostrar o sistema principal
        function mostrarSistemaPrincipal() {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('main-system').style.display = 'block';
            document.getElementById('current-user').textContent = usuarioAtual.nome;
            
            // Iniciar atualiza칞칚o da data e hora
            atualizarDataHora();
            intervaloAtualizacao = setInterval(atualizarDataHora, 1000);
            
            // Atualizar tempo da 칰ltima atualiza칞칚o
            document.getElementById('last-update-time').textContent = 
                new Date().toLocaleTimeString('pt-BR');
        }
        
        // Fun칞칚o para carregar quartos na visualiza칞칚o
        function carregarQuartos() {
            const container = document.getElementById('quartos-container');
            container.innerHTML = '';
            
            quartos[andarAtual].forEach(numero => {
                const hospede = hospedesAtivos.find(h => h.quarto === numero);
                const status = hospede ? 'ocupado' : 'disponivel';
                const pessoasTexto = hospede ? `${hospede.numPessoas} pessoa${hospede.numPessoas > 1 ? 's' : ''}` : '';
                
                const quartoElement = document.createElement('div');
                quartoElement.className = `quarto ${status}`;
                quartoElement.innerHTML = `
                    <div class="quarto-numero">${numero}</div>
                    <div class="quarto-status">
                        <i class="fas fa-bed"></i>
                    </div>
                    <div class="quarto-pessoas">${pessoasTexto}</div>
                    <button class="edit-btn">Editar</button>
                `;
                
                quartoElement.addEventListener('click', function(e) {
                    if (!e.target.classList.contains('edit-btn')) {
                        mostrarDetalhesQuarto(numero, hospede);
                    }
                });
                
                // Adicionar evento ao bot칚o de edi칞칚o
                quartoElement.querySelector('.edit-btn').addEventListener('click', function(e) {
                    e.stopPropagation();
                    abrirEdicaoCheckin(numero, hospede);
                });
                
                container.appendChild(quartoElement);
            });
            
            atualizarQuantidades();
        }
        
        // Fun칞칚o para carregar h칩spedes ativos
        function carregarHospedesAtivos() {
            const tbody = document.querySelector('#tabela-hospedes tbody');
            tbody.innerHTML = '';
            
            hospedesAtivos.forEach(hospede => {
                const nomesHospedes = hospede.nomes ? hospede.nomes.join(', ') : hospede.nome;
                const documentosHospedes = hospede.documentos ? hospede.documentos.join(', ') : hospede.documento;
                const telefonesHospedes = hospede.telefones ? hospede.telefones.join(', ') : hospede.telefone;
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${hospede.quarto}</td>
                    <td>${nomesHospedes}</td>
                    <td>${documentosHospedes}</td>
                    <td>${telefonesHospedes}</td>
                    <td>${hospede.numPessoas}</td>
                    <td>${formatarDataHora(hospede.entrada, hospede.horaEntrada)}</td>
                    <td>${formatarDataHora(hospede.saida, hospede.horaSaida)}</td>
                    <td>
                        <button class="edit-btn" data-quarto="${hospede.quarto}">Editar</button>
                        <button class="checkout-btn" data-quarto="${hospede.quarto}">Check-out</button>
                    </td>
                `;
                
                tbody.appendChild(tr);
            });
            
            // Adicionar eventos aos bot칫es de check-out
            document.querySelectorAll('.checkout-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const quarto = parseInt(this.getAttribute('data-quarto'));
                    fazerCheckout(quarto);
                });
            });
            
            // Adicionar eventos aos bot칫es de edi칞칚o
            document.querySelectorAll('.edit-btn').forEach(btn => {
                if (btn.getAttribute('data-quarto')) {
                    btn.addEventListener('click', function() {
                        const quarto = parseInt(this.getAttribute('data-quarto'));
                        const hospede = hospedesAtivos.find(h => h.quarto === quarto);
                        abrirEdicaoCheckin(quarto, hospede);
                    });
                }
            });
            
            atualizarQuantidades();
        }
        
        // Fun칞칚o para carregar hist칩rico
        function carregarHistorico() {
            const container = document.getElementById('historico-accordion');
            container.innerHTML = '';
            
            // Aplicar filtros
            const filtroStatus = document.getElementById('filtro-status').value;
            const filtroDataEntrada = document.getElementById('filtro-data-entrada').value;
            const filtroQuarto = document.getElementById('filtro-quarto').value;
            
            let historicoFiltrado = [...historico];
            
            // Filtrar por status
            if (filtroStatus !== 'todos') {
                historicoFiltrado = historicoFiltrado.filter(item => {
                    if (filtroStatus === 'ativo') return item.status === 'ativo';
                    if (filtroStatus === 'finalizado') return item.status === 'finalizado' && !item.checkoutAutomatico;
                    if (filtroStatus === 'automatico') return item.checkoutAutomatico;
                    return true;
                });
            }
            
            // Filtrar por data de entrada
            if (filtroDataEntrada) {
                historicoFiltrado = historicoFiltrado.filter(item => item.entrada === filtroDataEntrada);
            }
            
            // Filtrar por quarto
            if (filtroQuarto) {
                historicoFiltrado = historicoFiltrado.filter(item => item.quarto.toString().includes(filtroQuarto));
            }
            
            // Ordenar hist칩rico por data de entrada (mais recentes primeiro)
            historicoFiltrado.sort((a, b) => {
                const dataA = new Date(a.dataRegistro || a.entrada);
                const dataB = new Date(b.dataRegistro || b.entrada);
                return dataB - dataA;
            });
            
            if (historicoFiltrado.length === 0) {
                container.innerHTML = `
                    <div class="historico-vazio">
                        <i class="fas fa-history" style="font-size: 3rem; margin-bottom: 15px;"></i>
                        <p>Nenhum registro encontrado com os filtros aplicados</p>
                    </div>
                `;
                return;
            }
            
            historicoFiltrado.forEach((estadia, index) => {
                const nomesHospedes = estadia.nomes ? estadia.nomes.join(', ') : estadia.nome;
                const documentosHospedes = estadia.documentos ? estadia.documentos.join(', ') : estadia.documento;
                const telefonesHospedes = estadia.telefones ? estadia.telefones.join(', ') : estadia.telefone;
                
                // Determinar status e cor
                let statusTexto = 'Finalizado';
                let statusClasse = 'status-finalizado';
                
                if (estadia.status === 'ativo') {
                    statusTexto = 'Ativo';
                    statusClasse = 'status-ativo';
                } else if (estadia.checkoutAutomatico) {
                    statusTexto = 'Auto Finalizado';
                    statusClasse = 'status-automatico';
                }
                
                const item = document.createElement('div');
                item.className = 'historico-item';
                item.innerHTML = `
                    <div class="historico-header" data-index="${index}">
                        <div class="historico-info">
                            <div class="historico-info-item">
                                <span class="historico-info-label">Quarto</span>
                                <span class="historico-info-value">${estadia.quarto}</span>
                            </div>
                            <div class="historico-info-item">
                                <span class="historico-info-label">H칩spedes</span>
                                <span class="historico-info-value">${nomesHospedes}</span>
                            </div>
                            <div class="historico-info-item">
                                <span class="historico-info-label">Entrada</span>
                                <span class="historico-info-value">${formatarData(estadia.entrada)}</span>
                            </div>
                            <div class="historico-info-item">
                                <span class="historico-info-label">Status</span>
                                <span class="historico-info-value"><span class="status-historico ${statusClasse}">${statusTexto}</span></span>
                            </div>
                        </div>
                        <div class="historico-actions">
                            <button class="btn-detalhes" data-index="${index}">
                                <i class="fas fa-bee"></i> Detalhes
                            </button>
                            <i class="fas fa-chevron-down toggle-icon"></i>
                        </div>
                    </div>
                    <div class="historico-detalhes" data-index="${index}">
                        <div class="detalhes-grid">
                            <div class="detalhes-item">
                                <div class="detalhes-label">Quarto</div>
                                <div class="detalhes-value">${estadia.quarto}</div>
                            </div>
                            <div class="detalhes-item">
                                <div class="detalhes-label">N칰mero de Pessoas</div>
                                <div class="detalhes-value">${estadia.numPessoas}</div>
                            </div>
                            <div class="detalhes-item">
                                <div class="detalhes-label">Data/Hora de Entrada</div>
                                <div class="detalhes-value">${formatarDataHora(estadia.entrada, estadia.horaEntrada)}</div>
                            </div>
                            <div class="detalhes-item">
                                <div class="detalhes-label">Data/Hora de Sa칤da Prevista</div>
                                <div class="detalhes-value">${formatarDataHora(estadia.saida, estadia.horaSaida)}</div>
                            </div>
                            ${estadia.dataSaidaReal ? `
                            <div class="detalhes-item">
                                <div class="detalhes-label">Data/Hora de Sa칤da Real</div>
                                <div class="detalhes-value">${formatarDataHora(estadia.dataSaidaReal, estadia.horaSaidaReal)}</div>
                            </div>
                            ` : ''}
                            <div class="detalhes-item">
                                <div class="detalhes-label">Status</div>
                                <div class="detalhes-value"><span class="status-historico ${statusClasse}">${statusTexto}</span></div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <div class="hospede-titulo">H칩spedes</div>
                            <div class="detalhes-grid">
                                ${estadia.nomes ? estadia.nomes.map((nome, i) => `
                                    <div class="hospede-info">
                                        <div class="hospede-info-label">H칩spede ${i+1}</div>
                                        <div class="detalhes-value">
                                            <strong>Nome:</strong> ${nome}<br>
                                            <strong>Documento:</strong> ${estadia.documentos ? estadia.documentos[i] : 'N칚o informado'}<br>
                                            <strong>Telefone:</strong> ${estadia.telefones ? estadia.telefones[i] : 'N칚o informado'}
                                        </div>
                                    </div>
                                `).join('') : `
                                    <div class="hospede-info">
                                        <div class="hospede-info-label">H칩spede Principal</div>
                                        <div class="detalhes-value">
                                            <strong>Nome:</strong> ${estadia.nome || 'N칚o informado'}<br>
                                            <strong>Documento:</strong> ${estadia.documento || 'N칚o informado'}<br>
                                            <strong>Telefone:</strong> ${estadia.telefone || 'N칚o informado'}
                                        </div>
                                    </div>
                                `}
                            </div>
                        </div>
                        
                        ${estadia.checkoutAutomatico ? `
                        <div style="margin-top: 20px; padding: 10px; background-color: #fff3cd; border-radius: 4px;">
                            <i class="fas fa-info-circle"></i> Este check-out foi realizado automaticamente pelo sistema.
                        </div>
                        ` : ''}
                    </div>
                `;
                
                container.appendChild(item);
            });
            
            // Adicionar eventos para abrir/fechar os detalhes
            document.querySelectorAll('.historico-header').forEach(header => {
                header.addEventListener('click', function() {
                    const index = this.getAttribute('data-index');
                    const detalhes = document.querySelector(`.historico-detalhes[data-index="${index}"]`);
                    const toggleIcon = this.querySelector('.toggle-icon');
                    const btnDetalhes = this.querySelector('.btn-detalhes');
                    
                    // Fechar todos os outros itens abertos
                    document.querySelectorAll('.historico-detalhes').forEach(d => {
                        if (d !== detalhes) {
                            d.classList.remove('active');
                            const otherHeader = d.parentElement.querySelector('.historico-header');
                            otherHeader.classList.remove('active');
                            otherHeader.querySelector('.toggle-icon').classList.remove('aberto');
                            otherHeader.querySelector('.btn-detalhes').classList.remove('aberto');
                        }
                    });
                    
                    // Alternar o item atual
                    detalhes.classList.toggle('active');
                    this.classList.toggle('active');
                    toggleIcon.classList.toggle('aberto');
                    btnDetalhes.classList.toggle('aberto');
                });
            });
            
            // Adicionar eventos aos bot칫es de detalhes
            document.querySelectorAll('.btn-detalhes').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const index = this.getAttribute('data-index');
                    const header = document.querySelector(`.historico-header[data-index="${index}"]`);
                    header.click();
                });
            });
        }
        
        // Fun칞칚o para fazer check-out
        function fazerCheckout(quarto) {
            const hospedeIndex = hospedesAtivos.findIndex(h => h.quarto === quarto);
            
            if (hospedeIndex !== -1) {
                const hospede = hospedesAtivos[hospedeIndex];
                
                // Atualizar o registro no hist칩rico para marcar como finalizado
                const registroHistorico = historico.find(h => 
                    h.quarto === quarto && h.status === 'ativo' && !h.dataSaidaReal
                );
                
                if (registroHistorico) {
                    registroHistorico.status = 'finalizado';
                    registroHistorico.dataSaidaReal = new Date().toISOString().split('T')[0];
                    registroHistorico.horaSaidaReal = new Date().toTimeString().split(' ')[0].substring(0, 5);
                }
                
                // Remover dos h칩spedes ativos
                hospedesAtivos.splice(hospedeIndex, 1);
                
                salvarDados();
                
                // Atualizar visualiza칞칫es
                carregarQuartos();
                carregarHospedesAtivos();
                carregarHistorico();
                
                alert(`Check-out do quarto ${quarto} realizado com sucesso!`);
            }
        }
        
        // Fun칞칚o para abrir edi칞칚o de check-in
        function abrirEdicaoCheckin(quarto, hospede) {
            const modal = document.getElementById('modal-editar-checkin');
            const titulo = document.getElementById('modal-editar-titulo');
            const camposOcupado = document.getElementById('editar-campos-ocupado');
            
            titulo.textContent = `Editar Quarto ${quarto}`;
            
            // Preencher formul치rio com dados existentes, se houver
            document.getElementById('editar-quarto').value = quarto;
            
            if (hospede) {
                document.getElementById('editar-status').value = 'ocupado';
                camposOcupado.style.display = 'block';
                
                document.getElementById('editar-num-pessoas').value = hospede.numPessoas;
                
                // Preencher dados de entrada/sa칤da
                document.getElementById('editar-data-entrada').value = hospede.entrada || '';
                document.getElementById('editar-data-saida').value = hospede.saida || '';
                document.getElementById('editar-hora-entrada').value = hospede.horaEntrada || '14:00';
                document.getElementById('editar-hora-saida').value = hospede.horaSaida || '12:00';
                
                // Atualizar campos de h칩spedes
                atualizarCamposHospedes();
                
                // Preencher dados dos h칩spedes
                if (hospede.nomes && hospede.nomes.length > 0) {
                    for (let i = 0; i < hospede.nomes.length; i++) {
                        document.getElementById(`editar-nome-hospede${i+1}`).value = hospede.nomes[i];
                        document.getElementById(`editar-documento${i+1}`).value = hospede.documentos ? hospede.documentos[i] : '';
                        document.getElementById(`editar-telefone${i+1}`).value = hospede.telefones ? hospede.telefones[i] : '';
                    }
                } else {
                    // Compatibilidade com dados antigos
                    document.getElementById('editar-nome-hospede1').value = hospede.nome || '';
                    document.getElementById('editar-documento1').value = hospede.documento || '';
                    document.getElementById('editar-telefone1').value = hospede.telefone || '';
                }
            } else {
                document.getElementById('editar-status').value = 'disponivel';
                camposOcupado.style.display = 'none';
                
                // Limpar campos
                document.getElementById('editar-num-pessoas').value = '1';
                
                // Definir datas padr칚o
                const hoje = new Date().toISOString().split('T')[0];
                const amanha = new Date();
                amanha.setDate(amanha.getDate() + 1);
                const amanhaStr = amanha.toISOString().split('T')[0];
                
                document.getElementById('editar-data-entrada').value = hoje;
                document.getElementById('editar-data-saida').value = amanhaStr;
                document.getElementById('editar-hora-entrada').value = '14:00';
                document.getElementById('editar-hora-saida').value = '12:00';
                
                // Atualizar campos de h칩spedes
                atualizarCamposHospedes();
            }
            
            modal.style.display = 'flex';
        }
        
        // Fun칞칚o para salvar edi칞칚o de check-in
        function salvarEdicaoCheckin() {
            const quarto = parseInt(document.getElementById('editar-quarto').value);
            const status = document.getElementById('editar-status').value;
            
            const hospedeIndex = hospedesAtivos.findIndex(h => h.quarto === quarto);
            
            if (status === 'ocupado') {
                const numPessoas = parseInt(document.getElementById('editar-num-pessoas').value);
                const entrada = document.getElementById('editar-data-entrada').value;
                const saida = document.getElementById('editar-data-saida').value;
                const horaEntrada = document.getElementById('editar-hora-entrada').value;
                const horaSaida = document.getElementById('editar-hora-saida').value;
                
                // Validar se a data de sa칤da n칚o 칠 anterior  data de entrada
                if (new Date(saida) < new Date(entrada)) {
                    alert('A data de sa칤da n칚o pode ser anterior  data de entrada');
                    return;
                }
                
                // Coletar dados dos h칩spedes
                const nomes = [];
                const documentos = [];
                const telefones = [];
                
                for (let i = 1; i <= numPessoas; i++) {
                    const nome = document.getElementById(`editar-nome-hospede${i}`).value;
                    const documento = document.getElementById(`editar-documento${i}`).value;
                    const telefone = document.getElementById(`editar-telefone${i}`).value;
                    
                    if (!nome || !documento || !telefone) {
                        alert(`Por favor, preencha todos os dados do H칩spede ${i}`);
                        return;
                    }
                    
                    nomes.push(nome);
                    documentos.push(documento);
                    telefones.push(telefone);
                }
                
                // Atualizar ou adicionar h칩spede
                const hospede = {
                    quarto,
                    numPessoas,
                    nomes,
                    documentos,
                    telefones,
                    entrada,
                    saida,
                    horaEntrada,
                    horaSaida
                };
                
                if (hospedeIndex !== -1) {
                    // Atualizar h칩spede existente
                    hospedesAtivos[hospedeIndex] = hospede;
                    
                    // Atualizar tamb칠m no hist칩rico se existir
                    const registroHistorico = historico.find(h => 
                        h.quarto === quarto && h.status === 'ativo' && !h.dataSaidaReal
                    );
                    if (registroHistorico) {
                        Object.assign(registroHistorico, hospede);
                    }
                } else {
                    // Adicionar novo h칩spede
                    hospedesAtivos.push(hospede);
                    
                    // Registrar automaticamente no hist칩rico
                    const registroHistorico = {
                        ...hospede,
                        status: 'ativo',
                        dataRegistro: new Date().toISOString().split('T')[0],
                        horaRegistro: new Date().toTimeString().split(' ')[0].substring(0, 5)
                    };
                    historico.unshift(registroHistorico);
                }
            } else {
                // Remover h칩spede se existir
                if (hospedeIndex !== -1) {
                    const hospede = hospedesAtivos[hospedeIndex];
                    
                    // Marcar como finalizado no hist칩rico
                    const registroHistorico = historico.find(h => 
                        h.quarto === quarto && h.status === 'ativo' && !h.dataSaidaReal
                    );
                    if (registroHistorico) {
                        registroHistorico.status = 'finalizado';
                        registroHistorico.dataSaidaReal = new Date().toISOString().split('T')[0];
                        registroHistorico.horaSaidaReal = new Date().toTimeString().split(' ')[0].substring(0, 5);
                    }
                    
                    hospedesAtivos.splice(hospedeIndex, 1);
                }
            }
            
            salvarDados();
            
            // Fechar modal
            document.getElementById('modal-editar-checkin').style.display = 'none';
            
            // Atualizar visualiza칞칫es
            carregarQuartos();
            carregarHospedesAtivos();
            carregarHistorico();
            
            // Mostrar mensagem de sucesso
            alert('Altera칞칫es salvas com sucesso!');
        }
        
        // Fun칞칚o para mostrar detalhes do quarto
        function mostrarDetalhesQuarto(quarto, hospede) {
            const modal = document.getElementById('modal-quarto');
            const titulo = document.getElementById('modal-titulo');
            const conteudo = document.getElementById('modal-conteudo');
            
            titulo.textContent = `Quarto ${quarto}`;
            
            if (hospede) {
                const nomesHospedes = hospede.nomes ? hospede.nomes.join(', ') : hospede.nome;
                const documentosHospedes = hospede.documentos ? hospede.documentos.join(', ') : hospede.documento;
                const telefonesHospedes = hospede.telefones ? hospede.telefones.join(', ') : hospede.telefone;
                
                conteudo.innerHTML = `
                    <div class="status-indicator">
                        <div class="status-dot ocupado"></div>
                        <span>Ocupado</span>
                    </div>
                    <p><strong>H칩spedes:</strong> ${nomesHospedes}</p>
                    <p><strong>Documentos:</strong> ${documentosHospedes}</p>
                    <p><strong>Telefones:</strong> ${telefonesHospedes}</p>
                    <p><strong>N칰mero de pessoas:</strong> ${hospede.numPessoas}</p>
                    <p><strong>Entrada:</strong> ${formatarDataHora(hospede.entrada, hospede.horaEntrada)}</p>
                    <p><strong>Sa칤da prevista:</strong> ${formatarDataHora(hospede.saida, hospede.horaSaida)}</p>
                    <button class="edit-btn" style="margin-top: 15px;">Editar Check-in</button>
                    <button class="checkout-btn" style="margin-top: 10px;">Fazer Check-out</button>
                `;
                
                // Adicionar evento ao bot칚o de check-out
                conteudo.querySelector('.checkout-btn').addEventListener('click', function() {
                    fazerCheckout(quarto);
                    modal.style.display = 'none';
                });
                
                // Adicionar evento ao bot칚o de edi칞칚o
                conteudo.querySelector('.edit-btn').addEventListener('click', function() {
                    modal.style.display = 'none';
                    abrirEdicaoCheckin(quarto, hospede);
                });
            } else {
                conteudo.innerHTML = `
                    <div class="status-indicator">
                        <div class="status-dot disponivel"></div>
                        <span>Dispon칤vel</span>
                    </div>
                    <p>Este quarto est치 dispon칤vel para reserva.</p>
                    <button class="edit-btn" style="margin-top: 15px;" onclick="document.getElementById('modal-quarto').style.display = 'none'; abrirEdicaoCheckin(${quarto}, null);">Fazer Check-in</button>
                `;
            }
            
            modal.style.display = 'flex';
        }
        
        // Fun칞칚o para atualizar quantidades
        function atualizarQuantidades() {
            const totalQuartos = quartos.terreo.length + quartos.primeiro.length + quartos.segundo.length + 
                                quartos.tenis.length + quartos.soccer.length;
            const quartosOcupados = hospedesAtivos.length;
            
            document.getElementById('quantidade-quartos').textContent = totalQuartos;
            document.getElementById('quantidade-hospedes').textContent = quartosOcupados;
        }
        
        // Fun칞칚o para formatar apenas a data (sem hora)
        function formatarData(dataString) {
            if (!dataString) return '';
            
            const data = new Date(dataString);
            return data.toLocaleDateString('pt-BR');
        }
        
        // Fun칞칚o para formatar data e hora
        function formatarDataHora(dataString, horaString) {
            if (!dataString) return '';
            
            const data = new Date(dataString);
            const dataFormatada = data.toLocaleDateString('pt-BR');
            
            if (horaString) {
                return `${dataFormatada} 맙 ${horaString}`;
            }
            
            return dataFormatada;
        }
        
        // Fun칞칚o para salvar dados no localStorage
        function salvarDados() {
            localStorage.setItem('hospedesAtivos', JSON.stringify(hospedesAtivos));
            localStorage.setItem('historico', JSON.stringify(historico));
            localStorage.setItem('usuariosHWT', JSON.stringify(usuarios));
            
            // Marcar a 칰ltima atualiza칞칚o para sincroniza칞칚o
            const timestamp = new Date().toISOString();
            localStorage.setItem('ultimaAtualizacaoHWT', timestamp);
            ultimaAtualizacao = timestamp;
            
            // Tentar enviar para nuvem
            enviarParaNuvem();
            
            // Atualizar tempo da 칰ltima atualiza칞칚o
            document.getElementById('last-update-time').textContent = 
                new Date().toLocaleTimeString('pt-BR');
        }
    </script>
</body>
</html>
